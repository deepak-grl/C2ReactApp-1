<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>GRL-USB-PD-C2 API: Getting Started</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="GRL_Color.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">GRL-USB-PD-C2 API
   &#160;<span id="projectnumber">0.9.5</span>
   </div>
   <div id="projectbrief">GRL-USB-PD-C2 API Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Getting Started </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="intro_sec"></a>
Introduction</h1>
<div class="image">
<img src="image001.png" alt=""/>
</div>
<p> The GRL USB Type-C Power Delivery Tester and Analyzer (GRL-USB-PD-C2) is GRL's powerful USB Power Delivery (USB-PD) tester. GRL-USB-PD-C2 is approved by USB-IF for USB PD compliance testing. This document explains how to use GRL-USB-PD-C2 API's to create test cases to meet more customized test requirements. </p>
<h1><a class="anchor" id="Prerequisites"></a>
Prerequisites</h1>
<p>Following are the prerequisites for using the software: <br  />
 </p><ul style="list-style-type:circle">
<li>
This document assumes that users of API have knowledge on USB Power Delivery Specification  </li>
<li>
Knowledge of C# or Python to use the API  </li>
<li>
Visual Studio or any other IDE's  </li>
<li>
Laptop or PC with Windows 10 with minimum of 8GB of RAM  </li>
<li>
GRL-USB-PD-C2 Hardware  </li>
<li>
GRL-USB-PD-C2 software installed on the PC / Laptop  <br  />
 </li>
<li>
UUT (Unit under test)  <br  />
 </li>
</ul>
<h1><a class="anchor" id="Architecture"></a>
Architecture</h1>
<p>Custom test cases can be written in either C# or Python as independent standalone application. These test cases call the API's defined in GrlPdApiLib.dll and all the support functions and helper classes are defined in GrlPdLib.dll. The C2 Tester can emulate as provider, consumer and DRP devices. <br  />
 </p><div class="image">
<img src="Architecture.jpg" alt=""/>
</div>
<h1><a class="anchor" id="Hardwaresetup"></a>
Hardware Setup</h1>
<p>Following diagram illustrates the required hardware connection for using the API's along with the GRL-USB-PD-C2: <br  />
 </p><div class="image">
<img src="HardwareSetup.png" alt=""/>
</div>
<p> <br  />
 The GRL-USB-PD-C2 Software is loaded on a Windows 10 computer. Below is a procedure for connecting the hardware and computer. </p><ol type="1">
<li>
Connect the GRL-USB-PD-C2 Power Interface using the 24V, 280W Power Brick included with the controller.  </li>
<li>
Connect the GRL-USB-PD-C2 Controller using a physical Ethernet connection between the computer and the controller.  </li>
<li>
The Ethernet port on the control computer needs to be configured correctly for the GRL-USB-PD-C2 controller to recognize the control computer and vice versa.  </li>
<li>
To make sure the network connection is set up correctly, goto Network Connections from the Control Panel on the computer. <br  />
 <div class="image">
<img src="networkconnection.jpg" alt=""/>
</div>
 </li>
<li>
Open the Ethernet properties settings for the Ethernet port that will connect to the GRL-USB-PD-C2 controller, select “Internet Protocol Version 4 (TCP/IPv4)” and click on the “Properties” button below and to the right. <br  />
 <div class="image">
<img src="EthernetProperties.jpg" alt=""/>
</div>
 </li>
<li>
Set up the TCP/IPv4 properties as shown below and select “Use the following IP address:” to configure static IP address as 192.168.255.n where n is any number between 2 and 255. The subnet mask should be set as 255.255.255.0 and the default gateway as 192.168.255.1. The rest of the items will remain unchanged. <div class="image">
<img src="EthernetSettings.jpg" alt=""/>
</div>
 </li>
<li>
Once configured click the “OK” button and close the TCP/IPv4 Properties pop-up. Make sure the GRL-USB-PD-C2 Controller is powered on and completely booted up (front panel display showing firmware version number) and then connect the Ethernet cable from the GRL-USB-PD-C2 controller to the computer’s Ethernet port that was just set up. The Network Connections window should now appear as in the below image <div class="image">
<img src="connectioncmplete.jpg" alt=""/>
<div class="caption">
&lt;</div></div>
 </li>
<li>
The GRL-USB-PD-C2 Controller is now set up and ready for use.  </li>
<li>
<p class="startli">Before running any tests, it is recommended that you verify both the control computer and the GRL-USB-PD-C2 Controller are communicating properly by using ping 192.168.255.1 from command line.  &lt;\ol&gt;</p>
<p class="endli"></p>
</li>
</ol>
<h1><a class="anchor" id="SoftwareReq"></a>
Software Setup</h1>
<p>You can create custom test cases using Python or C#. To create API programming you need the following software: <br  />
 </p><ul style="list-style-type:circle">
<li>
Python 2.7.15 (Windows x86 MSI installer) or Visual Studio 2017  </li>
<li>
GRL-USB-PD-C2 Software  </li>
<li>
Python PIP  </li>
</ul>
<p><br  />
 </p><ol type="1">
<li>
If you want to use Python to create the custom test cases, install Python 2.7.15 (Windows x86 MSI installer) from <a href="https://www.python.org/downloads/release/python-2715/">https://www.python.org/downloads/release/python-2715/</a> <br  />
 Download the Python 2.7.15 installer and follow the on screen instructions to install the software  </li>
<li>
If you want to use C# to create the custom test cases install Visual Studio 2017 from <a href="https://visualstudio.microsoft.com/downloads/">https://visualstudio.microsoft.com/downloads/</a> <br  />
 Download the appropriate Visual Studio installer version and follow the on screen instructions to install the software.  </li>
<li>
All API libraries and helper functions are installed along with the GRL-USB-PD-C2 software. Download the GRL-USB-PD-C2 software from <a href="https://graniteriverlabs.com/download-center/">https://graniteriverlabs.com/download-center/</a> and follow the on screen instructions to install the software.  </li>
</ol>
<h1><a class="anchor" id="SettingUp"></a>
Development Environment Setup</h1>
<h2><a class="anchor" id="gettingStartedCSharp"></a>
Creating custom test cases in C#</h2>
<p>To develop the application in C#, follow the below instructions: <br  />
</p><ol type="1">
<li>Open Visual Studio 2017 or higher. <br  />
</li>
<li>Create a console application in Visual Studio wizard from the [File] menu, select [New]-[Project…], and click on Windows Forms App (.NET Framework)" or "Console App (.NET Framework)". <br  />
 <div class="image">
<img src="visualStudioNewProject.jpg" alt=""/>
</div>
 <br  />
</li>
<li>Add references to GrlPdApiLib.dll and GrlPdLib.dll under the project "Reference". <br  />
 <div class="image">
<img src="addReference.jpg" alt=""/>
</div>
 <br  />
</li>
<li>You are now set for C# application development; refer to the sample code documentation for further details. </li>
</ol>
<h2><a class="anchor" id="gettingStartedPython"></a>
Creating custom test cases in Python</h2>
<p>To develop the application in Python, follow the below instructions: <br  />
</p><ol type="1">
<li>Download and install version 2.7.15 of Python (Windows x86 MSI installer) from <a href="https://www.python.org/downloads/release/python-2715/">https://www.python.org/downloads/release/python-2715/</a> <br  />
 <br  />
</li>
<li>Launch GRL-USB-PD-C2 Software from desktop icon "GRL-USB-PD-C2 Software" <br  />
</li>
<li>Navigate to Connection configuration panel and click on "Update Firmware" button and follow on screen instructions to upgrade the firmware <br  />
</li>
<li>Close the GRL-USB-PD-C2 Software <br  />
</li>
<li>Launch Python utility from desktop icon "GRL-USB-PD-C2 Python API Tool" or from API installation folder path C:\GRL\GRL-USB_PD_C2\API\GRL-USB-PD-C2 Python API Tool <br  />
</li>
<li>Refer existing Python sample scripts in C:\GRL\GRL-USB_PD_C2\API\Sample Scripts - Python <br  />
 <div class="image">
<img src="Python_Utility.png" alt=""/>
</div>
 <br  />
</li>
<li>If you find any issue in running Python scripts, you may try below steps and if still issue exist please report it to <a href="#" onclick="location.href='mai'+'lto:'+'sup'+'po'+'rt@'+'gr'+'ani'+'te'+'riv'+'er'+'lab'+'s.'+'com'; return false;">suppo<span style="display: none;">.nosp@m.</span>rt@g<span style="display: none;">.nosp@m.</span>ranit<span style="display: none;">.nosp@m.</span>eriv<span style="display: none;">.nosp@m.</span>erlab<span style="display: none;">.nosp@m.</span>s.co<span style="display: none;">.nosp@m.</span>m</a></li>
<li>Add following Python installation paths to the system PATH variable C:\Python27; C:\Python27\Scripts ; C:\Python27\Lib. <br  />
</li>
<li>Download get-pip.py from <a href="https://pip.pypa.io/en/stable/installing/">https://pip.pypa.io/en/stable/installing/</a> and copy to C:\Python27. <br  />
</li>
<li>Open command prompt and navigate to C:\Python27. Type python get-pip.py to install PIP. <div class="image">
<img src="pipinstall.jpg" alt=""/>
</div>
 <br  />
</li>
<li>Install pythonnet via PIP by using the "pip install pythonnet" command in command prompt. <div class="image">
<img src="pythonnetinstall.jpg" alt=""/>
</div>
 <br  />
</li>
<li>You are now set for Python application development; refer to the sample code documentation for further details. </li>
</ol>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
